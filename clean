#!/bin/bash
# Clean temporary files generated by some tasks

FUNC="-ext"
EXT="java tex"
TEX=".aux .bbl .bcf .blg .lof .log .out .run.xml .toc"
JAVA=".class"

function OBJDelete(){
    for FILE in $(find . -type f -iname "*"$1 2>/dev/null)
    do
        for OBJ in $2
        do
            OBJ="${FILE/$1/$OBJ}"
            rm -f -v $OBJ
        done
    done
}

if [ "$#" -ne 2 ] ; then
    echo "Usage: clean [-func] [-predicate]"
    exit
elif [[ $FUNC != *"$1"* ]] ; then
    printf "List of available functions:\n$FUNC\n"
    exit
else
    case $1 in
    -ext)
        if [[ $EXT != *"$2"* ]] ; then
            printf "List of available predicates:\n$EXT\n"
            exit
        fi
        
    esac
fi

case $1 in
-ext)
    echo "Your working directory" is \'$(pwd)\'
    echo "This action will remove all "$2" aux files from this directory onwards."
    printf "Are you sure you want to continue? (Y/N) "
    read CHECK
    until [ \( $CHECK == 'Y' \) -o \( $CHECK == 'y' \) -o \( $CHECK == 'N' \) -o \( $CHECK == 'n' \) ]
    do
        printf "Invalid option. (Y/N) "
        read CHECK
    done
    if [ \( $CHECK == 'N' \) -o \( $CHECK == 'n' \) ] ; then
        echo "No changes made."
        exit
    fi
    case $2 in
    tex)
        OBJDelete ".tex" "$TEX"
    ;;
    java)
        OBJDelete ".java" "$JAVA"
    esac
esac
